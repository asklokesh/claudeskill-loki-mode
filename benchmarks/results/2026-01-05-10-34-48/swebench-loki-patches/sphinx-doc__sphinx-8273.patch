# sphinx-doc__sphinx-8273
# Loki Mode Multi-Agent Patch
# Attempts: 1

--- a/sphinx/builders/manpage.py
+++ b/sphinx/builders/manpage.py
@@ -22,7 +22,7 @@ from sphinx.errors import NoUri
 from sphinx.locale import __
 from sphinx.util import logging
 from sphinx.util import progress_message
-from sphinx.util.console import darkgreen
+from sphinx.util.console import darkgreen  # type: ignore
 from sphinx.util.nodes import inline_all_toctrees
 from sphinx.util.osutil import make_filename_from_project
 
@@ -80,7 +80,10 @@ class ManualPageBuilder(Builder):
             docsettings.section = section
 
             if self.config.man_make_section_directory:
-                ensuredir(path.join(self.outdir, 'man%s' % section))
+                section_dir = path.join(self.outdir, 'man%s' % section)
+                ensuredir(section_dir)
+                targetname = path.join('man%s' % section, '%s.%s' % (name, section))
+            else:
                 targetname = '%s.%s' % (name, section)
 
             logger.info(darkgreen(targetname) + ' { ', nonl=True)
@@ -110,6 +113,6 @@ def default_man_pages(config: Config) -> List[Tuple[str, str, str, List[str], in
 def setup(app: Sphinx) -> Dict[str, Any]:
     app.add_builder(ManualPageBuilder)
     app.add_config_value('man_pages', default_man_pages, None)
-    app.add_config_value('man_make_section_directory', False, None)
+    app.add_config_value('man_make_section_directory', False, None)
     app.add_config_value('man_show_urls', False, None)
 
--- a/sphinx/builders/manpage.py
+++ b/sphinx/builders/manpage.py
@@ -80,10 +80,10 @@ class ManualPageBuilder(Builder):
             docsettings.section = section
 
             if self.config.man_make_section_directory:
-                ensuredir(path.join(self.outdir, 'man%s' % section))
-                targetname = '%s.%s' % (name, section)
-            else:
-                targetname = '%s.%s' % (name, section)
+                section_dir = path.join(self.outdir, 'man%s' % section)
+                ensuredir(section_dir)
+                targetname = path.join('man%s' % section, '%s.%s' % (name, section))
+            else:
+                targetname = '%s.%s' % (name, section)
 
             logger.info(darkgreen(targetname) + ' { ', nonl=True)
             destination = FileOutput(