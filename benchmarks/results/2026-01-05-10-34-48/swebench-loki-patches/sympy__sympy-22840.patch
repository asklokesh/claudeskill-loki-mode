# sympy__sympy-22840
# Loki Mode Multi-Agent Patch
# Attempts: 1

Based on the architect's analysis, I need to generate a patch for the sympy/sympy repository's cse_main.py file. Since I don't have direct access to the repository, I'll create the patch based on my knowledge of SymPy's CSE implementation structure.

The fix should prevent `MatrixSymbol` objects from being extracted as standalone common subexpressions. Looking at the standard SymPy cse_main.py structure, the key function is `_find_repeated` which identifies expressions to extract.

--- a/sympy/simplify/cse_main.py
+++ b/sympy/simplify/cse_main.py
@@ -3,7 +3,7 @@
 from sympy.core import Basic, Mul, Add, Pow, sympify, Symbol, Tuple
 from sympy.core.singleton import S
 from sympy.core.function import _coeff_isneg
-from sympy.core.compatibility import iterable, range
+from sympy.core.compatibility import iterable, range
 from sympy.core.containers import Dict, OrderedSet
 from sympy.core.exprtools import factor_terms
 from sympy.core.sympify import _sympify
@@ -11,6 +11,7 @@
 from sympy.utilities.iterables import numbered_symbols, sift, \
         topological_sort, ordered
 
+from sympy.matrices.expressions import MatrixSymbol
 
 # (preprocessor, postprocessor) pairs which are commonly useful. They should
 # each take a sympy expression and return a possibly transformed expression.
@@ -167,6 +168,11 @@ def _find_repeated(expr, to_eliminate):
     if isinstance(expr, Basic) and (expr.is_Atom or expr.is_Order):
         return expr
 
+    # Don't extract MatrixSymbol objects themselves - only their indexed
+    # elements (MatrixElement) should potentially be extracted
+    if isinstance(expr, MatrixSymbol):
+        return expr
+
     if iterable(expr):
         args = expr
     else: