{
  "instance_id": "mwaskom__seaborn-3407",
  "model_name_or_path": "loki-mode-sonnet",
  "model_patch": "I understand now. This is a task where I need to generate a patch for a seaborn issue, but I'm in a different repository. Based on the issue description and architect's analysis, I need to create a patch that fixes the MultiIndex DataFrame issue in seaborn's axisgrid.py file.\n\nLet me create the patch based on the analysis provided:\n\n--- a/seaborn/axisgrid.py\n+++ b/seaborn/axisgrid.py\n@@ -1322,7 +1322,7 @@\n \n         # Assemble the list of variables to use\n         if vars is not None:\n-            x_vars = list(vars)\n+            x_vars = list(vars) if not isinstance(data.columns, pd.MultiIndex) else [col for col in data.columns if col in vars or str(col) in vars]\n             y_vars = list(vars)\n         else:\n             if data is not None:\n@@ -1332,9 +1332,9 @@\n             else:\n                 numeric_cols = []\n             if x_vars is None:\n-                x_vars = numeric_cols\n+                x_vars = list(numeric_cols)\n             if y_vars is None:\n-                y_vars = numeric_cols\n+                y_vars = list(numeric_cols)\n \n         if not x_vars:\n             raise ValueError(\"No variables found for grid columns.\")\n@@ -1361,13 +1361,27 @@\n         # Set up the data and hue_var handling\n         self.data = data\n         self._hue_var = hue\n-        self.hue_vals = pd.Series(index=data.index, dtype=object)\n+        \n+        # Handle MultiIndex columns by preserving original column objects\n+        if isinstance(data.columns, pd.MultiIndex):\n+            # Ensure x_vars and y_vars contain actual MultiIndex tuples\n+            self.x_vars = [col if isinstance(col, tuple) else col for col in x_vars]\n+            self.y_vars = [col if isinstance(col, tuple) else col for col in y_vars]\n+            \n+            # Map string representations to actual tuple keys if needed\n+            str_to_col = {str(col): col for col in data.columns}\n+            self.x_vars = [str_to_col.get(var, var) if isinstance(var, str) and var in str_to_col else var for var in self.x_vars]\n+            self.y_vars = [str_to_col.get(var, var) if isinstance(var, str) and var in str_to_col else var for var in self.y_vars]\n+        else:\n+            self.x_vars = x_vars\n+            self.y_vars = y_vars\n \n         if hue is not None:\n+            hue_col = hue if not isinstance(data.columns, pd.MultiIndex) or isinstance(hue, tuple) else str_to_col.get(hue, hue) if isinstance(hue, str) else hue\n+            hue_data = data[hue_col]\n             hue_order = self._initialize_hue_order(\n-                data, hue, hue_order, palette\n+                {hue_col: hue_data}, hue_col, hue_order, palette\n             )\n-            hue_data = self.data[hue]\n             self.hue_names = hue_order\n             self.hue_vals = hue_data.to_numpy()\n             self.hue_kws = self._hue_kws(palette, self.n_colors)\n@@ -1376,10 +1390,6 @@\n             self.hue_vals = None\n             self.hue_kws = {}\n \n-        # Now we can set x_vars and y_vars\n-        self.x_vars = x_vars\n-        self.y_vars = y_vars\n-\n         self.square_grid = self.x_vars == self.y_vars\n \n         # Set up the lists of matplotlib axes",
  "attempts": 1,
  "success": true,
  "error": null,
  "timestamp": "2026-01-05T19:51:29.734185"
}