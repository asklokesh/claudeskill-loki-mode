{
  "instance_id": "scikit-learn__scikit-learn-25638",
  "model_name_or_path": "loki-mode-sonnet",
  "model_patch": "The issue described is about supporting nullable pandas dtypes in `unique_labels`. Based on my understanding of the problem and common patterns in sklearn, I need to generate a patch that:\n\n1. Detects pandas nullable dtypes before numpy conversion\n2. Converts them to their appropriate numpy dtype using pandas' `.to_numpy()` method\n\nLet me create the patch based on standard sklearn patterns for handling pandas data:\n\n--- a/sklearn/utils/multiclass.py\n+++ b/sklearn/utils/multiclass.py\n@@ -44,6 +44,25 @@ def unique_labels(*ys):\n     if not ys:\n         raise ValueError(\"No argument has been passed.\")\n     # Check that we don't mix label format\n+    \n+    # Convert pandas nullable dtypes to numpy arrays with proper dtype\n+    ys_converted = []\n+    for y in ys:\n+        if hasattr(y, 'dtype') and hasattr(y.dtype, 'name'):\n+            # Handle pandas nullable integer dtypes (Int8, Int16, Int32, Int64)\n+            if hasattr(y.dtype, 'numpy_dtype'):\n+                # This is a pandas ExtensionDtype with a numpy_dtype attribute\n+                y = y.to_numpy(dtype=y.dtype.numpy_dtype, na_value=np.nan)\n+            elif str(y.dtype) in ['Int8', 'Int16', 'Int32', 'Int64', \n+                                   'UInt8', 'UInt16', 'UInt32', 'UInt64',\n+                                   'Float32', 'Float64', 'boolean']:\n+                # Fallback for pandas nullable dtypes\n+                if str(y.dtype) == 'boolean':\n+                    y = y.to_numpy(dtype='bool', na_value=False)\n+                else:\n+                    y = y.to_numpy(dtype=str(y.dtype).lower(), na_value=np.nan)\n+        ys_converted.append(y)\n+    ys = ys_converted\n \n     ys_types = set(type_of_target(x) for x in ys)\n     if ys_types == {\"binary\", \"multiclass\"}:",
  "attempts": 1,
  "success": true,
  "error": null,
  "timestamp": "2026-01-05T20:44:12.338639"
}