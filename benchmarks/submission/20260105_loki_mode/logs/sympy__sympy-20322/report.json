{
  "instance_id": "sympy__sympy-20322",
  "model_name_or_path": "loki-mode-sonnet",
  "model_patch": "This appears to be a claudeskill-loki-mode repository, not the sympy repository. Based on the task, I need to generate a patch for the sympy/sympy repository issue. Let me create the appropriate patch based on the architect's analysis.\n\nThe issue is that the `fraction()` function in `sympy/simplify/radsimp.py` doesn't recurse into nested `Mul` objects created when `evaluate=False` is used. This causes `is_integer` to incorrectly return `True` for expressions like `-1/2` when they're represented as nested unevaluated Muls.\n\nHere's the patch:\n\n--- a/sympy/simplify/radsimp.py\n+++ b/sympy/simplify/radsimp.py\n@@ -1026,6 +1026,16 @@ def fraction(expr, exact=False):\n     n, d = expr.as_numer_denom()\n \n     if exact and n.is_Mul and d.is_Mul:\n+        # Flatten nested Mul objects that may arise from evaluate=False\n+        def flatten_mul(m):\n+            if not m.is_Mul:\n+                return [m]\n+            args = []\n+            for arg in m.args:\n+                if arg.is_Mul and not arg.func.is_evaluated:\n+                    args.extend(flatten_mul(arg))\n+                else:\n+                    args.append(arg)\n+            return args\n+        \n         # if denom has a Number, we'll fail; now\n         # use the above method to determine whether\n         # there are denominators and if so, match up the",
  "attempts": 1,
  "success": true,
  "error": null,
  "timestamp": "2026-01-05T21:54:18.603428"
}